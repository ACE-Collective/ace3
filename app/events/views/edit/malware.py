from flask import render_template, request
from app.auth.permissions import require_permission
from app.blueprints import events
from saq.database.model import Malware
from saq.database.pool import get_db

@events.route('/new_malware_option', methods=['POST', 'GET'])
@require_permission('event', 'write')
def new_malware_option():
    index = request.args['index']
    malware = get_db().query(Malware).order_by(Malware.name.asc()).all()
    return render_template('events/new_malware_option.html', malware=malware, index=index)