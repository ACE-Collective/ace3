# IOC Extraction Configuration
#
# This file configures how IOCs are extracted from files and mapped to ACE observable types.
# It uses the Python library "iocsearcher" for initial IOC extraction, with additional custom patterns
# and exclusion patterns defined below.
#
# iocsearcher mappings - maps iocsearcher IOC types to ACE observable types
#
# See https://github.com/malicialab/iocsearcher/blob/main/iocsearcher/data/patterns.ini
# for the full list of iocsearcher's IOC types.
#
# Each mapping supports:
#   type: (required) The ACE observable type to create
#   directives: List of directives to add to extracted observables
#   tags: List of tags to add to extracted observables
#   volatile: Whether to add as volatile (default: false)
#   ignored_values: List of specific values to ignore
#   display_type: Custom display type for the UI
iocsearcher:
  url:
    type: url
    display_type: IOC
  fqdn:
    type: fqdn
    display_type: IOC
  ip4:
    type: ip
    display_type: IOC
  ip6:
    type: ip
    display_type: IOC
  email:
    type: email_address
    display_type: IOC
  md5:
    type: md5
    display_type: IOC
  sha1:
    type: sha1
    display_type: IOC
  sha256:
    type: sha256
    display_type: IOC
  

# Additional extraction patterns for IOC types iocsearcher doesn't handle.
# Each entry requires:
#   - pattern: A Python-compatible regular expression
#   - type: The ACE observable type to create
#
# Optional fields:
#   - directives: List of directives to add to extracted observables
#   - tags: List of tags to add to extracted observables
#   - volatile: Whether to add as volatile (default: false)
#   - display_type: Custom display type for the UI
#
# If the regex contains a capture group, the first group is used as the extracted value.
# If there are no capture groups, the entire match is used.
#
# Example:
#
# custom_patterns:
#   - pattern: "correlationId:\\s*([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})"
#     type: azure_correlation_id

custom_patterns: []

# Exclude patterns - regex matched against extracted (defanged/normalized) IOC values.
# Any IOC whose value matches an exclude pattern is dropped.
# Applied to results from BOTH iocsearcher and custom patterns above.
#
# Example:
#
# exclude_patterns:
#   - "example\\.com"
#   - "10\\.0\\.0\\."
#   - "(?i)benign-domain\\.org"

exclude_patterns: []
